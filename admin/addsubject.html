<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add New Subject</title>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        // Your Firebase project configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAFLeG3xlGCH9Ci7j8q6GBA1jDVyb3zSM4",
            authDomain: "utmsmartscan.firebaseapp.com",
            projectId: "utmsmartscan",
            storageBucket: "utmsmartscan.appspot.com",
            messagingSenderId: "150286309478",
            appId: "1:150286309478:web:4ec07841589ecfc34975a7"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        onAuthStateChanged(auth, (user) => {
            if (!user) {
                window.location.href = 'login.html';
            }
        });

        // Handle form submission
        const addSubjectForm = document.getElementById('addSubjectForm');
        addSubjectForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Get form values
            const subjectName = document.getElementById('subjectName').value;
            const subjectCode = document.getElementById('subjectCode').value;

            try {
                // Add new subject document to Firestore
                const docRef = await addDoc(collection(db, "subject"), {
                    subject_name: subjectName,
                    subject_code: subjectCode,
                });

                console.log("New subject created with ID: ", docRef.id);
                alert("Subject created successfully!");

                // Clear the form
                addSubjectForm.reset();
            } catch (error) {
                console.error("Error adding subject: ", error);
                alert("Failed to create the subject");
            }
        });

        
    </script>
</head>
<body>
    <h3>Create New Subject</h3>
    <form id="addSubjectForm">
        <label for="subjectName">Subject Name:</label><br>
        <input type="text" id="subjectName" name="subjectName" required><br><br>
        
        <label for="subjectCode">Subject Code:</label><br>
        <input type="text" id="subjectCode" name="subjectCode" required><br><br>

        <button type="submit">Create Subject</button>
    </form>

    
</body>
</html>
